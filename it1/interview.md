# Список вопросов:

## Собеседование с IT-One:

-----------------------

# Вопросы из записи в iCloud (ИТ1 тех собес 1/2):

# ОПЫТ:

## 1. Есть что-то такое что запомнилось как большой успех? Не успех работы, а что приятно лично вспоминать. (ОПЫТ)
https://www.linkedin.com/in/vitalylobachev/details/experience/ - пример опыта работа Лабочева Виталия

**Достижения в работе**:

1. Рефакторинг и приведение к единому стандарту инфраструктуры команд Банка что позволяет экономить время на конфигурацию сервера/сервисов.
2. Документация всей проделанной работы на досках в Jira, в Confluence, в пайплайнах, скриптах и конфигах что позволяет экономить своё время и сотрудников на изучение инфры и обучение сотрудников.
3. Настройка мониторинга для всех команд (серверов, устройств, контейнеров, сервисов и бд)
4. Настройка CI/CD для тестирования, сборок и доставки кода для разных команд Банка.
5. Автоматизация нотификаций, очистки логов/данных на серверах, создания УЗ, регистрации раннеров, выпуска сертификатов.
6. Траблшутинг проблем, сетевых доступов и пайплайнов.

## 2. Факапы за время работы DevOps? (ОПЫТ)

1. Дали чужой PROD сервер с рабочим allure-server и запущенными приложениями. Не 1 сервер - 1 сервис, а прод сервер с 30 запущенными сервисами и регулярно запускающимися авто-тестами в несколько потоков.
    1. Согласился разобраться с проблемами на проблемном сервере.
    2. Не изучил всю архитектуру и не сразу нашел корень проблемы.
    3. Ко мне пришли с проблемой что отчеты перестали писаться на диск. Нехватка места или проблема с allure-server.
    4. На сервере были внесены изменения в конфигурации сотрудником и был ребут сервака.
    5. После ребута отлетели mount диски и я ЭТО не проверил/не нашел сразу.
    6. Отчеты стали писаться на другой диск. 
    7. Забилась /root директория с др диском. 
    8. Очистка памяти не помогала.
    9. Приложения падали с ошибкой из-за нехватки места.
    10. Не сразу нашел ссылки на директории, в которые писались логи. (Символические ссылки)
2. Потратил уйму времени на локализацию главной проблемы что диск был отмонтирован и повлёк за собой пачку проблем.

## 3. Нужно зайти на сервер и посмотреть потребление ресурсов. Процессор/Память/Диск/Сеть. Какими командами? (Linux)

Просмотр потребления ресурсов (процессор, память, диск, сеть) на сервере Linux:

1. `top`, `htop` - Онлайн просмотр MEMORY и CPU

2. `free -h` - Просмотр использования памяти. 
    1. `lscpu` - информация о процессах
    2. `ps aux` - инфо о процессах (PID/USER/MEM/TIME/CPU)

3. `df -h`, `df -T`, `df -i` - Просмотр использования диска
    1. `du -axh --max-depth=1 /var` - folder used memory
    2. `tune2fs -l /dev/mapper/vg01-lv_var` - инфо по диску
    3. `ls -ltr | tail -1` - самый свежий файл
        1. `ls -lt | tail -1` - самый старый файл

4. `iftop`, `ip -s link` - Просмотр использования сети

5. `vgs` - volume groups

6. `iptables` - утилита для настройки правил брандмауэра в Linux. С помощью `iptables` можно управлять трафиком сетевых пакетов, определять, какие пакеты разрешены или блокированы, настраивать NAT (Network Address Translation), а также многое другое.

    Ключевые моменты об `iptables` (https://habr.com/ru/articles/747616/):

    1. **Таблицы**: `iptables` имеет различные таблицы, такие как `filter`, `nat`, `mangle`, `raw`, `security`. Каждая таблица используется для определенных целей, например, фильтрации пакетов (`filter`), NAT (`nat`), изменения заголовков пакетов (`mangle`).

    2. **Цепочки**: В рамках каждой таблицы существуют различные цепочки, такие как `INPUT`, `OUTPUT`, `FORWARD`. Цепочки определяют, куда направляются пакеты и какие правила применяются к ним.

    3. **Правила**: Правила `iptables` определяют, что делать с пакетами, которые проходят через брандмауэр. Правила могут разрешать, блокировать, перенаправлять или изменять пакеты в соответствии с заданными условиями.

    Через `iptables` можно просматривать текущие правила брандмауэра, смотреть статистику использования правил, добавлять новые правила, удалять и изменять существующие правила и т.д. 

    Например:

    1. `iptables -t nat -L` используется для просмотра правил NAT в таблице `nat`.
    2. `iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 8080` - для редиректа трафика с `--dport 80` до `--to-port 8080`
    3. `iptables -A INPUT -p tcp --dport 22 -m state --state NEW -m limit --limit 3/min -j ACCEPT` - для ограничения скорости
    4. `iptables -A INPUT -j LOG --log-prefix "Dropped Packet: " iptables -A INPUT -j DROP` - логирование всех отброшенных пакетов


## 4. Чем отличается системное от пользовательского времени (процессорное)? (Linux)

1. Пользовательское время — это время, затраченное процессором на выполнение команд, заданных пользовательской программой. 
2. Системное время — это время, затраченное на выполнение операционной системой и различными системными службами. 
3. Процессорное время может быть разделено между несколькими задачами или программами.

## 5. В Allure-server - ошибка: "No space left on device" и путь. df -h показывает что место есть. В чем проблема? (Linux)

1. Закончились Inodes (мета данные).
2. Проверю кол-во свободных инод на диске `df -i` или `df -ih`
3. Нужно увеличить размер диска что повлечет увеличение свободных inodes.
    1. Либо изменить файловую систему на более подходящую под задачи сервиса/сервера.
    2. `df -T` - fs Type: `ext4` (улучшенная версия ext3), `btrfs`, `XFS`, `FAT32`, `NTFS`:
        1. `ext4` - max размер раздела: 50-100тб, max размер файла: 16тб, max кол-во файлов - 4млрд
        2. `XFS` - max размер раздела: 8 экзабайт, max размер файла: 8 экзабайт, max кол-во файлов - 2 в 64 степени

## 6. Как потюнить Файловую систему? Какой командой её можно улучшить? (Linux)

Настройка и оптимизация файловой системы в Linux может повысить производительность и эффективность работы сервера. Одной из команд, которая может помочь улучшить файловую систему, является `tune2fs`.

`Tune2fs` - это утилита для настройки параметров файловых систем ext2/ext3/ext4. Некоторые параметры, которые можно настроить с помощью `tune2fs`:

1. **Интервал проверки файловой системы**: Можно изменить интервал проверки файловой системы на наличие ошибок при помощи опции `-c` (по количеству монтирований) или `-i` (по времени).

2. **Интервал записи журнала**: Можно изменить интервал записи журнала файловой системы с помощью опции `-J`.

3. **Размер журнала**: Можно изменить размер журнала файловой системы с помощью опции `-j`.

4. **Метка файловой системы**: Можно установить метку файловой системы с помощью опции `-L`.

5. **Максимальное количество монтирований**: Можно установить максимальное количество монтирований перед проверкой файловой системы с помощью опции `-C`.

Примеры использования `tune2fs`:

- Установить интервал проверки файловой системы на 30 дней:
```bash
sudo tune2fs -i 30d /dev/sdX
```

- Установить метку файловой системы:
```bash
sudo tune2fs -L "mylabel" /dev/sdX
```

## 7. Как поднять приоритет выполнения процесса на процессоре? (Linux)





## Продолжить (ИТ1 тех собес 1/2) с 0:09:42